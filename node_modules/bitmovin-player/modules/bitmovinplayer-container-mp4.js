/**************************************************************************** 
 * Copyright (C) 2021, Bitmovin, Inc., All Rights Reserved 
 * 
 * This source code and its use and distribution, is subject to the terms 
 * and conditions of the applicable license agreement. 
 * 
 * Bitmovin Player Version 8.60.0 
 * 
 ****************************************************************************/
(function() {
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["container-mp4"]=e():(t.bitmovin=t.bitmovin||{},t.bitmovin.player=t.bitmovin.player||{},t.bitmovin.player["container-mp4"]=e())}(this,function(){return webpackJsonpbitmovin_player__name_([21],{168:function(t,e,i){"use strict";function r(t){return void 0===t&&(t=0),{offset:t}}function s(t){return 0===t.length?null:t[0]}function a(t,e){var i=e.indexOf("."),r=[];if(i===-1)for(var s=0;s<t.length;s++)t[s].type===e&&r.push(t[s]);else for(var a=e.substr(0,i),n=e.substr(i+1),s=0;s<t.length;s++)t[s].type===a&&(r=r.concat(t[s].list(n)));return r}function n(t,i){t.forEach(function(t){e.ISOBox.prototype._boxParsers[t]=i})}function o(t,e){return t._cursor.offset-t._raw.byteOffset+e<=t.size}function h(t){if(!o(t,6))return{bytes_of_clear_data:0,bytes_of_encrypted_data:0};var e=t._readUint(16),i=t._readUint(32);return{bytes_of_clear_data:e,bytes_of_encrypted_data:i}}function f(t,e){return o(t,2)?(e.subsample_count=t._readUint(16),e.subsamples=Array.apply(null,Array(e.subsample_count)).map(function(e){return h(t)}),e):_(_({},e),{subsample_count:0,subsamples:[]})}function u(t){if(!o(t,t._root.options.iv_size))return void(t.samples=[]);var e={iv:t._readHex(t._root.options.iv_size)};return t.flags&&(e=f(t,e)),e}/*! codem-isoboxer v0.2.1 https://github.com/madebyhiro/codem-isoboxer/blob/master/LICENSE.txt */
var _=this&&this.__assign||function(){return _=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++){e=arguments[i];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},_.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var d=i(8),p=["moov","trak","tref","mdia","minf","stbl","edts","dinf","sinf","mvex","moof","traf","mfra","udta","meco","strk","vttc","schi"];e.ISOBoxer={parseBuffer:function(t,i){return void 0===i&&(i={}),new e.ISOFile(t,i).parse()}};var c=8;e.ISOFile=function(t,e){void 0===e&&(e={}),this.options=_({},e),this.options.iv_size=e.iv_size||c,t&&(this._raw=new DataView(t)),this._cursor=r(),this.boxes=[]},e.ISOFile.prototype.fetch=function(t){var e=this.fetchAll(t,!0);return e.length?e[0]:null},e.ISOFile.prototype.fetchAll=function(t,i){var r=[];return e.ISOFile._sweep.call(this,t,r,i),r},e.ISOFile.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var t=e.ISOBox.parse(this);if("undefined"==typeof t.type)break;this.boxes.push(t)}return this},e.ISOFile._sweep=function(t,i,r){this.type&&this.type===t&&i.push(this);for(var s in this.boxes){if(i.length&&r)return;e.ISOFile._sweep.call(this.boxes[s],t,i,r)}},e.ISOFile.prototype.get=function(t){return s(this.list(t))},e.ISOFile.prototype.list=function(t){return a(this.boxes,t)},e.ISOBox=function(){this._cursor=r()},e.ISOBox.parse=function(t){var i=new e.ISOBox;return i._offset=t._cursor.offset,i._root=t._root?t._root:t,i._raw=t._raw,i._parent=t,i._parseBox(),t._cursor.offset=i._raw.byteOffset+i._raw.byteLength,i},e.ISOBox.prototype.list=function(t){return a(this.boxes||this.entries||[],t)},e.ISOBox.prototype.get=function(t){return s(this.list(t))},e.ISOBox.prototype._readUint64=function(){var t=this._raw.getUint32(this._cursor.offset-this._raw.byteOffset),e=this._raw.getUint32(this._cursor.offset-this._raw.byteOffset+4);return t*Math.pow(2,32)+e},e.ISOBox.prototype._readInt64=function(){var t=this._raw.getInt32(this._cursor.offset-this._raw.byteOffset),e=this._raw.getInt32(this._cursor.offset-this._raw.byteOffset+4);return t*Math.pow(2,32)+e},e.ISOBox.prototype._readInt=function(t){var e=null;switch(t){case 8:e=this._raw.getInt8(this._cursor.offset-this._raw.byteOffset);break;case 16:e=this._raw.getInt16(this._cursor.offset-this._raw.byteOffset);break;case 32:e=this._raw.getInt32(this._cursor.offset-this._raw.byteOffset);break;case 64:e=this._readInt64()}return this._cursor.offset+=t>>3,e},e.ISOBox.prototype._readUint=function(t){var e=null;switch(t){case 8:e=this._raw.getUint8(this._cursor.offset-this._raw.byteOffset);break;case 16:e=this._raw.getUint16(this._cursor.offset-this._raw.byteOffset);break;case 24:var i=this._raw.getUint16(this._cursor.offset-this._raw.byteOffset),r=this._raw.getUint8(this._cursor.offset-this._raw.byteOffset+2);e=(i<<8)+r;break;case 32:e=this._raw.getUint32(this._cursor.offset-this._raw.byteOffset);break;case 64:e=this._readUint64()}return this._cursor.offset+=t>>3,e},e.ISOBox.prototype._readUintArray=function(t,e){for(var i=new Array(e),r=0;r<e;++r)i[r]=this._readUint(t);return i},e.ISOBox.prototype._readFP=function(t){return this._readInt(2*t)/Math.pow(2,t)},e.ISOBox.prototype._readString=function(t){for(var e="",i=0;i<t;i++){var r=this._readUint(8);e+=String.fromCharCode(r)}return e},e.ISOBox.prototype._readHex=function(t){for(var e=[],i=0;i<t;i++){var r=this._readUint(8);e.push((r>>>4).toString(16)),e.push((15&r).toString(16))}return e.join("")},e.ISOBox.prototype._readUUID=function(){return this._readUintArray(8,16)},e.ISOBox.prototype._readTerminatedString=function(){for(var t="";;){var e=this._readUint(8);if(0==e)break;t+=String.fromCharCode(e)}return t},e.ISOBox.prototype._readTemplate=function(t){var e=this._readUint(t/2),i=this._readUint(t/2);return e+i/Math.pow(2,t/2)},e.ISOBox.prototype._parseBox=function(){if(this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)return void(this._root._incomplete=!0);switch(this.size=this._readUint(32),this.type=this._readString(4),1===this.size&&(this.largesize=this._readUint(64)),"uuid"===this.type&&(this.usertype=this._readUUID()),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}!this._incomplete&&this._boxParsers[this.type]&&this._boxParsers[this.type].call(this)},e.ISOBox.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},e.ISOBox.prototype._createDataView=function(){return new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset))},e.ISOBox.prototype._boxParsers={},n(p,function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(e.ISOBox.parse(this))}),e.ISOBox.prototype._boxParsers.elst=function(){this._parseFullBox(),this.entry_count=this._readUint(32),this.entries=[];for(var t=1;t<=this.entry_count;t++){var i=new e.ISOBox;1===this.version?(i.segment_duration=this._readUint(64),i.media_time=this._readInt(64)):(i.segment_duration=this._readUint(32),i.media_time=this._readInt(32)),i.media_rate_integer=this._readInt(16),i.media_rate_fraction=this._readInt(16),this.entries.push(i)}},e.ISOBox.prototype._boxParsers.emsg=function(){this._parseFullBox(),this.scheme_id_uri=this._readTerminatedString(),this.value=this._readTerminatedString(),this.timescale=this._readUint(32),this.presentation_time_delta=this._readUint(32),this.event_duration=this._readUint(32),this.id=this._readUint(32),this.message_data=this._createDataView()},n(["free","mdat"],function(){this.data=this._createDataView()}),n(["ftyp","styp"],function(){for(this.major_brand=this._readString(4),this.minor_versions=this._readUint(32),this.compatible_brands=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.compatible_brands.push(this._readString(4))}),e.ISOBox.prototype._boxParsers.hdlr=function(){this._parseFullBox(),this.pre_defined=this._readUint(32),this.handler_type=this._readString(4),this.reserved=[this._readUint(32),this._readUint(32),this._readUint(32)],this.name=this._readTerminatedString()},e.ISOBox.prototype._boxParsers.mdhd=function(){this._parseFullBox(),1==this.version?(this.creation_time=this._readUint(64),this.modification_time=this._readUint(64),this.timescale=this._readUint(32),this.duration=this._readUint(64)):(this.creation_time=this._readUint(32),this.modification_time=this._readUint(32),this.timescale=this._readUint(32),this.duration=this._readUint(32));var t=this._readUint(16);this.pad=t>>15,this.language=String.fromCharCode((t>>10&31)+96,(t>>5&31)+96,(31&t)+96),this.pre_defined=this._readUint(16)},e.ISOBox.prototype._boxParsers.mfhd=function(){this._parseFullBox(),this.sequence_number=this._readUint(32)},e.ISOBox.prototype._boxParsers.mvhd=function(){this._parseFullBox(),1===this.version?(this.creation_time=this._readUint(64),this.modification_time=this._readUint(64),this.timescale=this._readUint(32),this.duration=this._readUint(64)):(this.creation_time=this._readUint(32),this.modification_time=this._readUint(32),this.timescale=this._readUint(32),this.duration=this._readUint(32)),this.rate=this._readTemplate(32),this.volume=this._readTemplate(16),this.reserved1=this._readUint(16),this.reserved2=[this._readUint(32),this._readUint(32)],this.matrix=[];for(var t=0;t<9;t++)this.matrix.push(this._readTemplate(32));for(this.pre_defined=[],t=0;t<6;t++)this.pre_defined.push(this._readUint(32));this.next_track_ID=this._readUint(32)},e.ISOBox.prototype._boxParsers.sidx=function(){this._parseFullBox(),this.reference_ID=this._readUint(32),this.timescale=this._readUint(32),0===this.version?(this.earliest_presentation_time=this._readUint(32),this.first_offset=this._readUint(32)):(this.earliest_presentation_time=this._readUint(64),this.first_offset=this._readUint(64)),this.reserved=this._readUint(16),this.reference_count=this._readUint(16),this.references=[];for(var t=0;t<this.reference_count;t++){var e={},i=this._readUint(32);e.reference_type=i>>31&1,e.referenced_size=2147483647&i,e.subsegment_duration=this._readUint(32);var r=this._readUint(32);e.starts_with_SAP=r>>31&1,e.SAP_type=r>>28&7,e.SAP_delta_time=268435455&r,this.references.push(e)}},e.ISOBox.prototype._boxParsers.ssix=function(){this._parseFullBox(),this.subsegment_count=this._readUint(32),this.subsegments=[];for(var t=0;t<this.subsegment_count;t++){var e={};e.ranges_count=this._readUint(32),e.ranges=[];for(var i=0;i<e.ranges_count;i++){var r={};r.level=this._readUint(8),r.range_size=this._readUint(24),e.ranges.push(r)}this.subsegments.push(e)}},e.ISOBox.prototype._boxParsers.tfdt=function(){this._parseFullBox(),1===this.version?this.baseMediaDecodeTime=this._readUint(64):this.baseMediaDecodeTime=this._readUint(32)},e.ISOBox.prototype._boxParsers.tfhd=function(){this._parseFullBox(),this.track_ID=this._readUint(32),1&this.flags?(this.base_data_offset_present=!0,this.base_data_offset=this._readUint(64)):131072&this.flags&&(this.default_base_is_moof=!0),2&this.flags&&(this.sample_description_offset=this._readUint(32)),8&this.flags&&(this.default_sample_duration=this._readUint(32)),16&this.flags&&(this.default_sample_size=this._readUint(32)),32&this.flags&&(this.default_sample_flags=this._readUint(32))},e.ISOBox.prototype._boxParsers.tkhd=function(){this._parseFullBox(),1===this.version?(this.creation_time=this._readUint(64),this.modification_time=this._readUint(64),this.track_ID=this._readUint(32),this.reserved1=this._readUint(32),this.duration=this._readUint(64)):(this.creation_time=this._readUint(32),this.modification_time=this._readUint(32),this.track_ID=this._readUint(32),this.reserved1=this._readUint(32),this.duration=this._readUint(32)),this.reserved2=[this._readUint(32),this._readUint(32)],this.layer=this._readUint(16),this.alternate_group=this._readUint(16),this.volume=this._readTemplate(16),this.reserved3=this._readUint(16),this.matrix=[];for(var t=0;t<9;t++)this.matrix.push(this._readTemplate(32));this.width=this._readTemplate(32),this.height=this._readTemplate(32)},e.ISOBox.prototype._boxParsers.trun=function(){this._parseFullBox(),this.sample_count=this._readUint(32),1&this.flags&&(this.data_offset_present=!0,this.data_offset=this._readInt(32)),4&this.flags&&(this.first_sample_flags=this._readUint(32)),this.samples=[];for(var t=0;t<this.sample_count;t++){var e={};256&this.flags&&(e.sample_duration=this._readUint(32)),512&this.flags&&(e.sample_size=this._readUint(32)),1024&this.flags&&(e.sample_flags=this._readUint(32)),2048&this.flags&&(0==this.version?e.sample_composition_time_offset=this._readUint(32):e.sample_composition_time_offset=this._readInt(32)),this.samples.push(e)}},e.ISOBox.prototype._boxParsers.trex=function(){this._parseFullBox(),this.track_ID=this._readUint(32),this.default_sample_description_index=this._readUint(32),this.default_sample_duration=this._readUint(32),this.default_sample_size=this._readUint(32),this.default_sample_flags=this._readUint(32)},e.ISOBox.prototype._boxParsers.stsd=function(){for(this._parseFullBox(),this.entry_count=this._readUint(32),this.entries=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.entries.push(e.ISOBox.parse(this))},e.ISOBox.prototype._boxParsers.encv=function(){for(this._readHex(6),this.data_reference_index=this._readUint(16),this._readUint(16),this._readUint(16),this._readUint(32),this._readUint(32),this._readUint(32),this.width=this._readUint(16),this.height=this._readUint(16),this.horizresolution=this._readTemplate(32),this.vertresolution=this._readTemplate(32),this._readUint(32),this.frame_count=this._readUint(16),this._readUint(8),this.compressor_name=this._readString(4),this.depth=this._readUint(16),this._readUint(16),this._readHex(27),this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(e.ISOBox.parse(this))},n(["enca","mp4a"],function(){for(this._readHex(6),this.data_reference_index=this._readUint(16),this._readUint(32),this._readUint(32),this.channel_count=this._readUint(16),this.sample_size=this._readUint(16),this._readUint(16),this._readUint(16),this.sample_rate=this._readUint(32)>>>16,this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(e.ISOBox.parse(this))});var l=function(){this._readUint(32),this._readUint(16),this.data_reference_index=this._readUint(16),this.version=this._readUint(16),this.revision_level=this._readUint(16),this.vendor=this._readUint(32),this.temporal_quality=this._readUint(32),this.spatial_quality=this._readUint(32),this.width=this._readInt(16),this.height=this._readInt(16),this.horizontal_resolution=this._readTemplate(32),this.vertical_resolution=this._readTemplate(32),this.data_size=this._readUint(32),this.frame_count=this._readUint(16);var t=this._readUint(8);this.compressor_name="";for(var i=0;i<31;i++){var r=this._readUint(8);i<t&&(this.compressor_name+=String.fromCharCode(r))}for(this.depth=this._readUint(16),this.color_table_id=this._readUint(16),this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(e.ISOBox.parse(this))};n(["avc1","hvc1","hev1"],l),e.ISOBox.prototype._boxParsers.avcC=function(){this.configuration_version=this._readUint(8),this.avc_profile_indication=this._readUint(8),this.profile_compatibility=this._readUint(8),this.avc_level_indication=this._readUint(8);var t=this._readUint(8);this.complete_representation=t>>>7&1,this.length_size_minus_one=3&t,this.num_sps=31&this._readUint(8),this.sps=[];for(var e=0;e<this.num_sps;++e)this.sps.push(this._readUintArray(8,this._readUint(16)));this.num_pps=31&this._readUint(8),this.pps=[];for(var e=0;e<this.num_pps;++e)this.pps.push(this._readUintArray(8,this._readUint(16)))},e.ISOBox.prototype._boxParsers.hvcC=function(){var t;this.configurationVersion=this._readUint(8),t=this._readUint(8),this.general_profile_space=t>>>6,this.general_tier_flag=t>>>5&1,this.general_profile_idc=31&t,this.general_profile_compatibility_flags=this._readUint(32),this.general_constraint_indicator_flags_bytes=[];for(var e=0;e<6;e++)this.general_constraint_indicator_flags_bytes[e]=this._readUint(8);this.general_level_idc=this._readUint(8),this.min_spatial_segmentation_idc=4095&this._readUint(16),this.parallelismType=3&this._readUint(8),this.chroma_format_idc=3&this._readUint(8),this.bit_depth_luma_minus8=7&this._readUint(8),this.bit_depth_chroma_minus8=7&this._readUint(8),this.avgFrameRate=this._readUint(16),t=this._readUint(8),this.constantFrameRate=t>>>6,this.numTemporalLayers=t>>>3&7,this.temporalIdNested=t>>>2&1,this.lengthSizeMinusOne=3&t,this.numOfArrays=this._readUint(8)},e.ISOBox.prototype._boxParsers.esds=function(){this._parseFullBox(),this._readUint(16),this.esId=this._readUint(16),this.streamPriority=31&this._readUint(8),this._readUint(16),this.decoderConfig={},this.decoderConfig.objectProfileIndication=this._readUint(8),this.decoderConfig.streamType=this._readUint(8)>>>2&63,this.decoderConfig.bufferSize=this._readUint(24),this.decoderConfig.maxBitrate=this._readUint(32),this.decoderConfig.avgBitrate=this._readUint(32),this.decoderConfig.decoderConfigDescriptor={},this.decoderConfig.decoderConfigDescriptor.tag=this._readUint(8),this.decoderConfig.decoderConfigDescriptor.length=this._readUint(8);var t=this._readUint(8),e=this._readUint(8),i=this.decoderConfig.decoderConfigDescriptor;i.audioObjectType=t>>>3&31,i.samplingFrequencyIndex=(7&t)<<1|e>>>7&1,i.channelConfiguration=e>>>3&15},e.ISOBox.prototype._boxParsers.tenc=function(){this._parseFullBox(),this.default_is_encrypted=1===this._readUint(24),this.default_iv_size=this._readUint(8),this.default_kid=this._readHex(16)},e.ISOBox.prototype._boxParsers.senc=function(){var t=this;this._parseFullBox(),this.sample_count=this._readUint(32),this.samples=Array.apply(null,Array(this.sample_count)).map(function(e){return u(t)})},e.ISOBox.prototype._boxParsers.frma=function(){this.codingname=this._readString(4)},e.ISOBox.prototype._boxParsers.schm=function(){this._parseFullBox(),this.scheme_type=this._readString(4),this.scheme_version=this._readUint(32),1&this.flags&&(this.scheme_uri=this._readUint(8))},e.ISOBox.prototype._boxParsers.saiz=function(){if(this._parseFullBox(),1&this.flags&&(this.aux_info_type=this._readUint(32),this.aux_info_type_parameter=this._readUint(32)),this.default_sample_info_size=this._readUint(8),this.sample_count=this._readUint(32),0===this.default_sample_info_size){this.sample_info_size=[];for(var t=0;t<this.sample_count;++t)this.sample_info_size.push(this._readUint(8))}},e.ISOBox.prototype._boxParsers.pssh=function(){if(this._parseFullBox(),this.system_id=this._readUUID(),this.version>0){this.kid_count=this._readUint(32),this.kids=[];for(var t=0;t<this.kid_count;++t)this.kids.push(this._readString(16))}this.data_size=this._readUint(32),this.data=new DataView(this._raw.buffer,this._cursor.offset,this.data_size)},e.ISOBox.prototype._boxParsers.uuid=function(){var t=[130,64,196,173,84,149,78,127,140,16,89,8,248,110,243,177];d.ArrayHelper.comparePrimitiveArrays(this.usertype,t)&&(this.qosData=this._raw.buffer.slice(this._cursor.offset,this._cursor.offset+this.size))},e.ISOBox.prototype._boxParsers.prft=function(){this._parseFullBox(),this.reference_track_ID=this._readUint(32),this.ntp_timestamp_seconds=this._readUint(32),this.ntp_timestamp_seconds_fraction=this._readUint(32),0===this.version?this.media_time=this._readUint(32):this.media_time=this._readUint(64)}},236:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8),s=function(){function t(t){this.context=t,this.buffer=new ArrayBuffer(0)}return t.parseIsoBoxType=function(t,e){return String.fromCharCode(t[e])+String.fromCharCode(t[e+1])+String.fromCharCode(t[e+2])+String.fromCharCode(t[e+3])},t.prototype.appendData=function(t){this.buffer=r.ArrayHelper.concatBuffers(this.buffer,t)},t.prototype.getCompleteChunks=function(){var e=t.findCompleteCmafChunks(this.buffer);if(0===e.length)return null;this.context.logger.insane("Found "+e.length+" CMAF chunks");var i=e[e.length-1].end,r=this.buffer.slice(0,i);return this.buffer=this.buffer.slice(i),r},t.findCompleteCmafChunks=function(e){if(!e||e.byteLength<8)return[];for(var i=new DataView(e),r=[],s=["moof","mdat"],a=0,n=[],o=0;o+8<e.byteLength;){var h=i.getUint32(o),f=t.parseIsoBoxType(new Uint8Array(e),o+4);if(0===h)break;o+h<=e.byteLength&&(n.push(f),f===s[0]&&s.shift(),0===s.length&&(r.push({start:a,end:o+h,boxes:n}),s=["moof","mdat"],a=o+h+1,n=[])),o+=h}return r},t.prototype.reset=function(){this.buffer.byteLength>0&&this.context.logger.debug("CMAF chunk parser discarded "+this.buffer.byteLength+" bytes"),this.buffer=new ArrayBuffer(0)},t}();e.CmafChunkParser=s},237:function(t,e,i){"use strict";function r(t){var e=[],i=[];i.push.apply(i,t.list("moov.pssh")),i.push.apply(i,t.list("moof.pssh"));for(var r=0,s=i;r<s.length;r++){var a=s[r];a.kids&&a.kids.length>0&&e.push.apply(e,a.kids)}return e}function s(t,e,i,r){var s=e.slice(i,i+r);return t.decrypt(s).then(function(t){new Uint8Array(e).set(new Uint8Array(t),i)})}function a(t,e,i,r,a){var n,o=(n=a.subsample_count,null!==n&&void 0!==n?n:0);if(o>0&&a.subsamples){for(var h=[],f=0;f<o;++f){i+=a.subsamples[f].bytes_of_clear_data;var u=a.subsamples[f].bytes_of_encrypted_data;u>0&&(h.push(s(t,e,i,u)),i+=u)}return Promise.all(h).then(function(){})}return s(t,e,i,r)}function n(t,e){return t=o(t,e.uuidBox),t=o(t,e.sencBox),t=o(t,e.saioBox),t=o(t,e.saizBox)}function o(t,e){if(!e)return t;for(var i=new Uint8Array(t),r=new DataView(t),s=e._parent;s&&s.type;)r.setUint32(s._offset,s.size-e.size),s.size-=e.size,s=s._parent;var a=e._root.get("moof.traf.trun");a&&(r.setInt32(a._offset+16,a.data_offset-e.size),a.data_offset-=e.size);var n=new Uint8Array(t.byteLength-e.size);return n.set(i.subarray(0,e._offset),0),n.set(i.subarray(e._offset+e.size),e._offset),n.buffer}Object.defineProperty(e,"__esModule",{value:!0});var h=i(168),f=i(8),u=i(27),_=i(2),d=i(0),p=8,c=function(){function t(t,e,i){this.context=t,this.keys=e,this.isDataEncrypted=!1,this.mimeType=i,this.keyIds=[]}return t.prototype.parseInitSegment=function(t){for(var e=this,i=h.ISOBoxer.parseBuffer(t),s=i._raw.buffer,a=r(i),n=0,_=a;n<_.length;n++){var d=_[n];this.storeKeyId(d)}var p=i.get("moov.trak.mdia.minf.stbl.stsd"),c=p.entries[0];return c.list("sinf").forEach(function(t){var r=t.get("frma"),a=t.get("schm"),n=t.get("schi.tenc");if(r&&n&&a){for(var h=0;h<4;++h)i._raw.setUint8(c._offset+4+h,r.codingname.charCodeAt(h));e.defaultIsEncrypted=n.default_is_encrypted,e.defaultIVSize=n.default_iv_size,e.defaultKid=n.default_kid,e.isDataEncrypted=!0;var _=f.ArrayHelper.arrayBufferToAsciiString(u.FormatHelper.hexToBytes(e.defaultKid),!0);e.storeKeyId(_)}s=o(s,t)}),Promise.resolve(s)},t.prototype.storeKeyId=function(t){this.keyIds.includes(t)||this.keyIds.push(t)},t.prototype.getKeyIds=function(){return this.keyIds},t.prototype.addKeys=function(t){for(var e=function(t){var e=i.keys.find(function(e){return e.kid===t.kid});e?e.key=t.key:i.keys.push(t)},i=this,r=0,s=t;r<s.length;r++){var a=s[r];e(a)}},t.prototype.getKey=function(){if(this.key)return this.key;var t;for(var e in this.keys)if(this.keys.hasOwnProperty(e)){var i=this.keys[e].hasOwnProperty("key")&&this.keys[e].hasOwnProperty("kid");if(i&&this.keys[e].kid===this.defaultKid){t=this.keys[e].key;break}}return void 0===t&&(t=this.keys[0].key),"string"==typeof t?this.key=u.FormatHelper.hexToBytes(t).buffer:t instanceof Uint8Array?this.key=t.buffer:this.key=t,this.key},t.prototype.decryptDataSegment=function(t){if(!this.getKey())return this.context.logger.debug("MP4Decrypter.decryptSegment: Error decrypting AES-128 encrypted content"),Promise.reject("Error decrypting AES-128 encrypted content");if(this.isEncrypted()===!1)return this.context.logger.debug("MP4Decrypter.decryptSegment: NO ENCRYPTED CONTENT"),Promise.reject("NO ENCRYPTED CONTENT");for(var e=h.ISOBoxer.parseBuffer(t,{iv_size:this.defaultIVSize}),i=new l(e),r=[],s=0;s<i.getSampleCount();++s)r.push(this.decryptSample(t,i,s));return Promise.all(r).then(function(){return n(t,i)})},t.prototype.decryptSample=function(t,e,i){var r=e.sampleToOffset(i),s=e.sampleToSize(i,1),n=e.getSampleEncodeInfo(i);if(!n.iv)return this.context.logger.debug("MP4Decrypter.decryptSegment: NO INITIAL VECTOR PROVIDED"),Promise.reject("NO INITIAL VECTOR PROVIDED");var o=_.ModuleManager.get(d.ModuleName.Crypto).CryptoApi,h=new o(this.context,"AES-CTR",this.getKey(),n.iv,this.mimeType,(!0));return a(h,t,r,s,n)},t.prototype.isEncrypted=function(){return this.isDataEncrypted},t}();e.MP4Decrypter=c;var l=function(){function t(t){var e=t.get("moof.traf");this.trunBox=e.get("trun"),this.sencBox=e.get("senc"),this.uuidBox=e.get("uuid"),this.saizBox=e.get("saiz"),this.saioBox=e.get("saio"),this.mdatOffset=t.get("mdat")._offset+p}return t.prototype.getSampleSizeTable=function(){return this.trunBox.samples},t.prototype.getSampleCount=function(){return this.getSampleSizeTable().length},t.prototype.getSampleEncodeInfo=function(t){return this.sencBox.samples[t]},t.prototype.sampleToOffset=function(t){return this.mdatOffset+this.sampleToSize(0,t)},t.prototype.sampleToSize=function(t,e){for(var i,r=this.getSampleSizeTable(),s=0,a=t;a<t+e;a++)i=r[a].sample_size,s+=null!==i&&void 0!==i?i:0;return s},t}()},238:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6),s=i(7),a=i(85),n=i(64),o=i(8),h=i(31),f=i(27),u=i(5),_=function(){function t(t){var e=this;this.FULL_BOX_TYPES={stsd:function(t){t+=n.ISOBMFFConstants.FULL_BOX_VERSION_LENGTH+n.ISOBMFFConstants.FULL_BOX_FLAGS_LENGTH;var i;switch(e.boxTypes[0]){case"vide":i=e.FULL_BOX_TYPES.encv;break;case"soun":i=e.FULL_BOX_TYPES.enca;break;case"hint":case"meta":case"auxv":e.context.logger.debug("handler type "+e.boxTypes[0]+" not yet supported");break;default:e.context.logger.debug("invalid handler type "+e.boxTypes[0])}return i?t+=4:(e.context.logger.debug("unsupported handler type "+e.boxTypes[0]),-1)},encv:function(t){var e=6,i=2,r=2,s=2,a=12,n=2,o=2,h=4,f=4,u=4,_=2,d=32,p=2,c=2;return t+=e+i+r+s+a+n+o+h+f+u+_+d+p+c},enca:function(t){var e=6,i=2,r=8,s=2,a=2,n=2,o=2,h=4;return t+=e+i+r+s+a+n+o+h}},this.context=t}return t.prototype.readBoxSize=function(t,e){var i=t.getUint32(e);return i<=0?null:i},t.prototype.readBoxType=function(t,e){for(var i="",r=0;r<n.ISOBMFFConstants.BOX_TYPE_LENGTH;r++){var s=t.getInt8(e+r);i+=String.fromCharCode(s)}return i},t.prototype.parse=function(t,e){for(var i,r,s=0,a=e,o=[],h=new DataView(t);s+3<h.byteLength;){if(r=this.readBoxSize(h,s),i=this.readBoxType(h,s+n.ISOBMFFConstants.BOX_SIZE_LENGTH),null===r)return this.context.logger.debug("size is 0, maybe an error, or the largesize should be parsed. Returning with null."),[];if(i!==a[0])s+=r;else{if(a.length<=1)o.push(t.slice(s,s+r));else{var f=s;if(s+=n.ISOBMFFConstants.BOX_SIZE_LENGTH+n.ISOBMFFConstants.BOX_TYPE_LENGTH,this.FULL_BOX_TYPES.hasOwnProperty(i)){var u=this.FULL_BOX_TYPES[i](s);u!==-1&&(s=u)}var _=s-f;_=r-_;var d=t.slice(s,s+_),p=this.parse(d,e.slice(1));p&&(o=o.concat(p)),s=f}s+=r}}return o.length>0?o:[]},t.prototype.parseHandlerType=function(t){for(var e=["moov","trak","mdia","hdlr"],i=this.parse(t,e),r=[],s=4,a=0;a<i.length;a++){var o=new DataView(i[a]),h=n.ISOBMFFConstants.BOX_SIZE_LENGTH+n.ISOBMFFConstants.BOX_TYPE_LENGTH;h+=n.ISOBMFFConstants.FULL_BOX_VERSION_LENGTH+n.ISOBMFFConstants.FULL_BOX_FLAGS_LENGTH,h+=s,r.push(this.readBoxType(o,h))}return r},t.prototype.extractDefaultKIDFromTenc=function(t){if(!t||!(t instanceof ArrayBuffer)||t.byteLength<1)return null;var e=new DataView(t),i=3,r=1,s=16,a=n.ISOBMFFConstants.BOX_SIZE_LENGTH+n.ISOBMFFConstants.BOX_TYPE_LENGTH;a+=n.ISOBMFFConstants.FULL_BOX_VERSION_LENGTH+n.ISOBMFFConstants.FULL_BOX_FLAGS_LENGTH+i+r;for(var o="",h=0;h<s;h++)o+=f.FormatHelper.intToHex(e.getUint8(a+h));return o},t.prototype.parseDefaultKIDFromBuffer=function(t,e){this.boxTypes=this.parseHandlerType(t);var i;i=u.MimeTypeHelper.isVideo(e)?["moov","trak","mdia","minf","stbl","stsd","encv","sinf","schi","tenc"]:["moov","trak","mdia","minf","stbl","stsd","enca","sinf","schi","tenc"];var r=this.parse(t,i);if(!r||r.length<1)return null;for(var s=[],a=0;a<r.length;a++){var n=this.extractDefaultKIDFromTenc(r[a]);null!==n&&s.push(n)}return this.context.logger.debug("default KID extracted: "+s),s},t.prototype.arrayBufferToString=function(t){return o.ArrayHelper.arrayBufferToAsciiString(t,!0)},t.prototype.getDataFromPsshBox=function(t){if(!t||!(t instanceof ArrayBuffer)||t.byteLength<3)return this.context.logger.debug("could not parse pssh data from box"),null;this.context.logger.debug(this.arrayBufferToString(t));var e={},i=new DataView(t),r=0;r+=n.ISOBMFFConstants.BOX_SIZE_LENGTH+n.ISOBMFFConstants.BOX_TYPE_LENGTH;var s=i.getUint8(r);r+=n.ISOBMFFConstants.FULL_BOX_VERSION_LENGTH+n.ISOBMFFConstants.FULL_BOX_FLAGS_LENGTH;for(var h="",u=0;u<n.ISOBMFFConstants.PSSH_SYSTEM_ID_LENGTH;u++)h+=f.FormatHelper.intToHex(i.getUint8(r)),r++;if(e.systemIDraw=h,e.systemID="urn:uuid:"+f.FormatHelper.beautifyUUID(h),a.DRMSchemeIDURIs.hasOwnProperty(e.systemID)&&(e.systemName=a.DRMSchemeIDURIs[e.systemID]),s>0){var _=i.getUint32(r);r+=4,e.kid=[];for(var u=0;u<_;u++){var d=o.ArrayHelper.extractHexString(i,r,n.ISOBMFFConstants.PSSH_KID_LEN);r+=n.ISOBMFFConstants.PSSH_KID_LEN,e.kid.push(d)}}return e.initData=t.slice(0),e.initDataStr=this.arrayBufferToString(e.initData),e},t.prototype.parsePsshBox=function(t){if(t.getMimeType().indexOf("mp4")<0)return null;var e=t.getData();if(!(e&&e instanceof ArrayBuffer))return null;var i=[];i=i.concat(this.parse(e,["moov","pssh"])),i=i.concat(this.parse(e,["moof","pssh"]));var a=t.isEncrypted();if(a&&!i.length&&t.isInit()&&h.isTizen2016())return this.context.eventHandler.fireError(new s.PlayerError(r.ErrorCode.SEGMENT_PSSH_DATA_MISSING)),[];var n=[];if(Array.isArray(i))for(var o=0;o<i.length;o++){var f=this.getDataFromPsshBox(i[o]);null!==f&&n.push(f)}return n},t}();e.MP4EncryptionParser=_},239:function(t,e,i){"use strict";function r(t,e,i){var r=e.fetch("sidx"),s=0,a=t.getTimescale();if(void 0===a)return 0;if(r&&r.earliest_presentation_time)s=r.earliest_presentation_time/a;else{var n=e.fetch("tfdt");n&&n.baseMediaDecodeTime&&(s=n.baseMediaDecodeTime/a)}return"number"==typeof s?s-=i:s=0,s}function s(t,e,i,r){var s=a(t.moof,t.mdat,e,r);return s.map(function(t){return t.nalus=n(t.data,i),t})}function a(t,e,i,r){var s,a,n,o,h=t.get("traf"),u=h.get("tfhd"),_=h.get("trun"),d=(s=u.base_data_offset,null!==s&&void 0!==s?s:t._offset),p=(a=_.data_offset,null!==a&&void 0!==a?a:0);return(null===(o=null===(n=_)||void 0===n?void 0:n.samples)||void 0===o?void 0:o.length)?_.samples.map(function(t){var s=t.sample_size||u.default_sample_size||i.getDefaultSampleSize();s>_._raw.buffer.byteLength&&(s=_._raw.buffer.byteLength-(d+p),r.warn("trun.samples.sample_size ("+t.sample_size+") is bigger than the available buffer length:"+_._raw.buffer.byteLength+". Adjusting to remaining bytes:"+s)),1!==_.sample_count||t.sample_size||(s=e.size-f(e));var a={duration:t.sample_duration||u.default_sample_duration||i.getDefaultSampleDuration(),size:s,compositionTimeOffset:t.sample_composition_time_offset||0,data:new DataView(_._raw.buffer,d+p,s)};return p+=s,a}):[]}function n(t,e){void 0===e&&(e=[]);for(var i=5,r=[],s=0;s+i<t.byteLength;){var a=Math.min(t.getUint32(s),t.byteLength-s-i);if(s+=4,0!==a){var n=31&t.getUint8(s);if(s++,0===e.length||e.includes(n)){var h={type:n,data:new DataView(t.buffer,t.byteOffset+s,a-1)};o(h),r.push(h)}s+=a-1}}return r}function o(t){for(var e=[],i=1;i<t.data.byteLength-2;)0===t.data.getUint8(i)&&0===t.data.getUint8(i+1)&&3===t.data.getUint8(i+2)?(e.push(i+2),i+=3):i++;if(0!==e.length){for(var r=new DataView(new ArrayBuffer(t.data.byteLength-e.length)),s=0,a=0;s<r.byteLength;s++,a++)e[0]===a&&(e.shift(),a++),r.setUint8(s,t.data.getInt8(a));t.data=r}}function h(t){var e=t.getParsedData().fetchAll("moof"),i=t.getParsedData().fetchAll("mdat");return e.length===i.length?e.map(function(t,e){return{moof:t,mdat:i[e]}}):[]}function f(t){return t.hasOwnProperty("largesize")?P.ISOBMFFConstants.BOX_HEADER_LENGTH_LARGE:P.ISOBMFFConstants.BOX_HEADER_LENGTH_REGULAR}function u(t){var e=d(t.getData()),i=e.fetch("tfdt");return i?i._raw.byteOffset:0}function _(t,e){var i=e.get("moof.traf.tfhd");return i?i.track_ID?i.track_ID:(t.log("Track fragment header has no track_ID field. This does not look like a valid mp4."),-1):(t.log("Cannot extract trackID from data fragment."),-1)}function d(t,e,i){return void 0===e&&(e={}),void 0===i&&(i=B.ISOBoxer),i.parseBuffer(t,e)}function p(t,e){var i=x(t),r=i.get("moof.traf.tfdt");U(t,e);var s=t.getTimescale();return r&&void 0!==s?r.baseMediaDecodeTime/s:void 0===s?NaN:void 0}function c(t,e,i){if(void 0===e&&(e={}),void 0===i&&(i=B.ISOBoxer),!t.getParsedData()){var r=d(t.getData(),e,i);t.setParsedData(r)}return t.getParsedData()}function l(t){var e,i=x(t);return e=t.isInit()?["ftyp","moov"]:["moof","mdat"],e.every(function(t){return Boolean(i.fetch(t))})}function m(t){var e=v(t);if(!e)return null;var i=e.entries[0],r=i.get("esds")||{},s=r.decoderConfig;if(!s)return null;var a=i.type,n=s.objectProfileIndication.toString(16),o=s.decoderConfigDescriptor.audioObjectType;return a+"."+n+"."+o}function g(t){var e=v(t);if(!e)return null;var i=e.entries.find(function(t){return I(w.VisualSampleEntryTypes.Avc,w.VisualSampleEntryTypes.Hvc).includes(t.type)});return i?w.VisualSampleEntryTypes.Avc.includes(i.type)?b(i):w.VisualSampleEntryTypes.Hvc.includes(i.type)?E.assembleHvcCodecString(i.type,i.get("hvcC")):null:null}function y(t){var e=c(t);return g(e)||m(e)}function v(t){return t.get("moov.trak.mdia.minf.stbl.stsd");
}function b(t){var e=t.get("avcC");if(!e||0===e.sps.length)return null;var i=t.type,r=C.FormatHelper.bytesToHex(new Uint8Array(e.sps[0].splice(1,3)));return i+"."+r}function x(t,e){return void 0===e&&(e=B.ISOBoxer),c(t,{iv_size:t.getIvSize()||A},e)}function U(t,e){var i=t.getParsedData().get("moov.trak.mdia.mdhd");if(i){var r=i.timescale;t.setTimescale(r),e.debug("timescale for "+t.getMimeType()+" is "+r)}}function S(t){t.getParsedData().fetch("senc")&&t.setEncrypted(!0)}var I=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;for(var r=Array(t),s=0,e=0;e<i;e++)for(var a=arguments[e],n=0,o=a.length;n<o;n++,s++)r[s]=a[n];return r};Object.defineProperty(e,"__esModule",{value:!0});var B=i(168),O=i(6),T=i(7),D=i(23),w=i(180),P=i(64),F=i(8),E=i(26),C=i(27),k=i(5),M=i(2),L=i(0),z=i(394),A=8,H=function(){function t(t,e,i){void 0===i&&(i=B.ISOBoxer),this.context=t,this.mp4EncryptionParser=e,this.isoBoxer=i,this.CryptoModule=M.ModuleManager.get(L.ModuleName.Crypto,!1)}return t.prototype.parseSegment=function(t){return"mp4"!==k.MimeTypeHelper.extractContainerType(t.getMimeType())?void this.context.logger.debug("Skipping parsing of a non MP4 segment"):(t.isInit()?this.parseInitSegment(t):t.isInit()||this.parseDataSegment(t),void t.setDrmInitData(this.extractDrmInitData(t)))},t.prototype.extractDrmInitData=function(t){var e,i=this,r=this.mp4EncryptionParser.parsePsshBox(t);return null===(e=r)||void 0===e?void 0:e.forEach(function(t){return i.context.logger.debug("initData found: "+t.initDataStr)}),Array.isArray(r)&&r.length>0?r:[]},t.prototype.parseTrackDefaultParameters=function(t){var e=t.getParsedData().get("moov.mvex.trex");if(e){var i={defaultSampleSize:e.default_sample_size,defaultSampleDuration:e.default_sample_duration};t.updateParserMetadata(i),this.context.logger.debug("default sample duration for "+t.getMimeType()+" : "+i.defaultSampleDuration)}},t.prototype.parseTrackEncryptionBox=function(t){var e,i=this.mp4EncryptionParser.parseDefaultKIDFromBuffer(t.getData(),t.getMimeType()),r=(null===(e=i)||void 0===e?void 0:e.length)?i.pop():void 0,s=t.getParsedData().get("moov.trak.mdia.minf.stbl.stsd.encv.sinf.schi.tenc")||t.getParsedData().get("moov.trak.mdia.minf.stbl.stsd.enca.sinf.schi.tenc");s&&(t.updateParserMetadata({ivSize:s.default_iv_size}),t.setEncrypted(!0)),r&&t.setDrmKid(C.FormatHelper.beautifyUUID(r))},t.prototype.nullifyBox=function(t){t._raw.setUint32(4,1936419184)},t.prototype.isSupportedEdtsBox=function(t){var e=t.get("elst");return!(e&&e.entries.length>0&&e.entries[0].media_time<0)},t.prototype.parseInitSegment=function(t){var e=c(t,{},this.isoBoxer);if(!e)return void this.context.eventHandler.fireError(new T.PlayerError(O.ErrorCode.SOURCE_EMPTY_SEGMENT));this.parseTrackEncryptionBox(t),U(t,this.context.logger),this.parseTrackDefaultParameters(t),this.context.settings.IGNORE_MP4_EDTS_BOX&&this.removeUnsupportedEdtsBox(e);var i=e.get("moov.uuid");this.shouldDecryptQosData(i)&&this.decryptQoSInformation(i,t)},t.prototype.removeUnsupportedEdtsBox=function(t){var e=t.get("moov.trak.edts");e&&!this.isSupportedEdtsBox(e)&&(this.context.logger.debug("Found unsupported edts box, dropping it!"),this.nullifyBox(e))},t.prototype.shouldDecryptQosData=function(t){return t&&t.qosData&&null!=this.CryptoModule},t.prototype.decryptQoSInformation=function(t,e){var i=this;this.CryptoModule.QoSDecrypter.decrypt(this.context,t.qosData,e.getMimeType()).then(function(t){if("string"==typeof t&&t.length>0){var e=JSON.parse(t);i.context.logger.debug("Quality information found"),i.context.eventHandler.dispatchEvent(D.InternalEvent.QOSDataAvailable,e,!0)}})["catch"](function(t){i.context.logger.debug(t),i.context.logger.log("could not read quality data")})},t.prototype.parseDataSegment=function(e){var i,r,s,a=0,n=e.getSegmentInfo();(null===(i=n)||void 0===i?void 0:i.presentationTimeOffset)&&(a=n.presentationTimeOffset);var o=this.getParsedSegmentIsoFile(e);e.isSelfInit()&&this.parseTrackDefaultParameters(e),this.parseTrackEncryptionBox(e),e.setEncrypted((s=null===(r=e.getInitSegment())||void 0===r?void 0:r.isEncrypted(),null!==s&&void 0!==s&&s)),S(e),U(e,this.context.logger),this.parseSegmentTimingInformation(e,a,o),this.addDuration(e),e.setInbandEvents(this.parseInbandEvents(e,a)),e.setLastSegment(this.parseIsLastSegment(e));var h=t.getProducerReferenceTime(e);h&&(n.wallClockTime=h)},t.prototype.addDuration=function(t){var e=this.parseSegmentDuration(t);if(e){var i=Math.abs(t.getDuration()-e);i>.5&&this.context.logger.debug("Segment duration is off by "+i+", corrected from "+t.getDuration()+" to "+e),t.setDuration(e)}},t.prototype.parseSegmentTimingInformation=function(t,e,i){var r=i.get("moof.traf.tfdt");if(r){var s=t.getTimescale();t.setTFDTBoxOffset(r._offset),t.setBaseMediaDecodeTime(r.baseMediaDecodeTime),t.setPresentationTimeOffset(e),void 0===s?this.context.logger.debug("Could not set playback time - segment is missing timescale."):t.setPlaybackTime(r.baseMediaDecodeTime/s-e)}},t.prototype.getParsedSegmentIsoFile=function(t){return c(t,{iv_size:t.getIvSize()||A},this.isoBoxer)},t.prototype.parseSegmentDuration=function(t){var e=this,i=t.getTimescale();if(!k.MimeTypeHelper.isAV(t.getMimeType()))return null;if(void 0===i)return this.context.logger.debug("Could not parse segment duration - segment is missing timescale."),null;var r=t.getParsedData().list("moof.traf"),s=r.reduce(function(i,r){return i+e.calculateTrackFragmentDuration(r,t.getDefaultSampleDuration())},0);return s/i},t.prototype.calculateTrackFragmentDuration=function(t,e){var i,r=t.get("trun");if(!r)return this.context.logger.insane("Media segment is missing trun box!"),0;var s=t.get("tfhd"),a=s?s.default_sample_duration:null,n=null===(i=r.samples)||void 0===i?void 0:i.reduce(function(t,i){var r=i.sample_duration||a||e||0;return t+r},0);return null!==n&&void 0!==n?n:0},t.prototype.parseInbandEvents=function(t,e){var i=this.getParsedSegmentIsoFile(t),s=r(t,i,e),a=i.fetchAll("emsg");return a.map(function(t){return{schemeIdUri:t.scheme_id_uri,value:t.value,presentationTime:s+t.presentation_time_delta/t.timescale,eventDuration:t.event_duration/t.timescale,id:String(t.id),messageData:F.ArrayHelper.convertBufferSourceToUTF8(t.message_data)}})},t.parseFourCharsText=function(t,e){for(var i="",r=0;r<4;r++){var s=t.getInt8(e+r);i+=String.fromCharCode(s)}return i},t.prototype.parseIsLastSegment=function(e){var i=e.getData();if(!i||i.byteLength<4)return!1;for(var r,s=new DataView(i),a=0;a+3<s.byteLength;){var n=s.getUint32(a);if(n<=0)return!1;if(r=t.parseFourCharsText(s,a+4),"styp"===r){a+=8,a+=8;for(var o=void 0;a<n;)if(o=t.parseFourCharsText(s,a),a+=4,"lmsg"===o)return this.context.logger.debug("lmsg found, this should be the last segment in this stream"),!0;break}a+=n}return!1},t.getProducerReferenceTime=function(t){var e=t.getParsedData().fetch("prft");if(!e)return null;var i=1e3*e.ntp_timestamp_seconds;return i+=Math.round(e.ntp_timestamp_seconds_fraction/Math.pow(2,32)*1e3),z.ntpToUnix(i)},t}();e.MP4Parser=H,e.getAvcSamples=s,e.getTrackSamples=a,e.removeEmulationPreventionThreeBytes=o,e.getMp4Fragments=h,e.parseTfdtBoxOffset=u,e.getTrackId=_,e.parseBuffer=d,e.parsePlaybackTime=p,e.parseSegmentData=c,e.isValidSegment=l,e.getCodecFromSegment=y},393:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),s=i(236),a=i(237),n=i(238),o=i(239);e.ContainerMp4ModuleDefinition={name:r.ModuleName.ContainerMP4,module:{MP4Parser:o.MP4Parser,MP4Decrypter:a.MP4Decrypter,MP4EncryptionParser:n.MP4EncryptionParser,CmafChunkParser:s.CmafChunkParser,getMp4Fragments:o.getMp4Fragments,getAvcSamples:o.getAvcSamples,parseTfdtBoxOffset:o.parseTfdtBoxOffset,getTrackId:o.getTrackId,parseBuffer:o.parseBuffer,parsePlaybackTime:o.parsePlaybackTime,isValidSegment:o.isValidSegment,getCodecFromSegment:o.getCodecFromSegment,getTrackSamples:o.getTrackSamples}},e["default"]=e.ContainerMp4ModuleDefinition},394:function(t,e,i){"use strict";function r(t){return t+s}Object.defineProperty(e,"__esModule",{value:!0});var s=new Date(Date.UTC(1900,0,1)).getTime();e.ntpToUnix=r}},[393])});
})();
